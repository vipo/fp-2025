<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# OPTIONS_GHC -Wno-missing-export-lists #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-unrecognised-pragmas #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# HLINT ignore &quot;Redundant lambda&quot; #-}</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Lessons.Lesson05</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Monoid</span></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Char</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">isAlpha</span></span><span class="hs-special">)</span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">isPrefixOf</span></span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-comment">-- &gt;&gt;&gt; mappend [1,2,3] [4,5,6]</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- [1,2,3,4,5,6]</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-comment">-- &gt;&gt;&gt; mempty :: [Integer]</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- []</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-comment">-- &gt;&gt;&gt; map Sum [1,2,3]</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- [Sum {getSum = 1},Sum {getSum = 2},Sum {getSum = 3}]</span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-comment">-- &gt;&gt;&gt; getSum $ fold $ map Sum [1,2,3]</span><span>
</span><span id="line-22"></span><span class="hs-comment">-- 6</span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="hs-comment">-- &gt;&gt;&gt; getProduct $ fold $ map Product [1,2,3]</span><span>
</span><span id="line-25"></span><span class="hs-comment">-- 6</span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-keyword">newtype</span><span> </span><span id="MySum"><span class="annot"><a href="Lessons.Lesson05.html#MySum"><span class="hs-identifier hs-var">MySum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MySum"><span class="annot"><a href="Lessons.Lesson05.html#MySum"><span class="hs-identifier hs-var">MySum</span></a></span></span><span> </span><span class="hs-special">{</span><span id="getSum"><span class="annot"><span class="annottext">MySum -&gt; Integer
</span><a href="Lessons.Lesson05.html#getSum"><span class="hs-identifier hs-var hs-var">getSum</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">}</span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-comment">-- &gt;&gt;&gt; fold $ map All [True, True]</span><span>
</span><span id="line-30"></span><span class="hs-comment">-- All {getAll = True}</span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span class="hs-comment">-- &gt;&gt;&gt; fold $ map All [True, True, False]</span><span>
</span><span id="line-33"></span><span class="hs-comment">-- All {getAll = False}</span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-comment">-- &gt;&gt;&gt; fold $ map Any [True, True, False]</span><span>
</span><span id="line-36"></span><span class="hs-comment">-- Any {getAny = True}</span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-comment">-- &gt;&gt;&gt; fold $ map Any [False, False]</span><span>
</span><span id="line-39"></span><span class="hs-comment">-- Any {getAny = False}</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-keyword">type</span><span> </span><span id="ErrorMsg"><span class="annot"><a href="Lessons.Lesson05.html#ErrorMsg"><span class="hs-identifier hs-var">ErrorMsg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-43"></span><span class="hs-keyword">type</span><span> </span><span id="Parser"><span class="annot"><a href="Lessons.Lesson05.html#Parser"><span class="hs-identifier hs-var">Parser</span></a></span></span><span> </span><span id="local-6989586621679050496"><span class="annot"><a href="#local-6989586621679050496"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span id="local-6989586621679050497"><span class="annot"><a href="#local-6989586621679050497"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679050496"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679050497"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="annot"><a href="Lessons.Lesson05.html#parseLetter"><span class="hs-identifier hs-type">parseLetter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Lessons.Lesson05.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Lessons.Lesson05.html#ErrorMsg"><span class="hs-identifier hs-type">ErrorMsg</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span>
</span><span id="line-46"></span><span id="parseLetter"><span class="annot"><span class="annottext">parseLetter :: Parser ErrorMsg Char
</span><a href="Lessons.Lesson05.html#parseLetter"><span class="hs-identifier hs-var hs-var">parseLetter</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ErrorMsg -&gt; Either ErrorMsg (Char, [Char])
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;A letter is expected but got empty input&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-47"></span><span class="annot"><a href="Lessons.Lesson05.html#parseLetter"><span class="hs-identifier hs-var">parseLetter</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679050499"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679050499"><span class="hs-identifier hs-var">h</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679050500"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679050500"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isAlpha</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679050499"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-49"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(Char, [Char]) -&gt; Either ErrorMsg (Char, [Char])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679050499"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679050500"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ErrorMsg -&gt; Either ErrorMsg (Char, [Char])
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;A letter is expected, but got &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679050499"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="hs-comment">-- &gt;&gt;&gt; parseString &quot;&quot;</span><span>
</span><span id="line-53"></span><span class="hs-comment">-- Left [&quot;At least on value required&quot;]</span><span>
</span><span id="line-54"></span><span class="hs-comment">-- &gt;&gt;&gt; parseString &quot;afds&quot;</span><span>
</span><span id="line-55"></span><span class="hs-comment">-- Right (&quot;afds&quot;,&quot;&quot;)</span><span>
</span><span id="line-56"></span><span class="hs-comment">-- &gt;&gt;&gt; parseString &quot;afds5345&quot;</span><span>
</span><span id="line-57"></span><span class="hs-comment">-- Right (&quot;afds&quot;,&quot;5345&quot;)</span><span>
</span><span id="line-58"></span><span class="hs-comment">-- &gt;&gt;&gt; parseString &quot;afds 5345&quot;</span><span>
</span><span id="line-59"></span><span class="hs-comment">-- Right (&quot;afds&quot;,&quot; 5345&quot;)</span><span>
</span><span id="line-60"></span><span class="annot"><a href="Lessons.Lesson05.html#parseString"><span class="hs-identifier hs-type">parseString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Lessons.Lesson05.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Lessons.Lesson05.html#ErrorMsg"><span class="hs-identifier hs-type">ErrorMsg</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-61"></span><span id="parseString"><span class="annot"><span class="annottext">parseString :: Parser ErrorMsg [Char]
</span><a href="Lessons.Lesson05.html#parseString"><span class="hs-identifier hs-var hs-var">parseString</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser ErrorMsg Char -&gt; Parser ErrorMsg [Char]
forall a. Parser ErrorMsg a -&gt; Parser ErrorMsg [a]
</span><a href="Lessons.Lesson05.html#many1"><span class="hs-identifier hs-var">many1</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ErrorMsg Char
</span><a href="Lessons.Lesson05.html#parseLetter"><span class="hs-identifier hs-var">parseLetter</span></a></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span id="local-6989586621679050443"><span id="local-6989586621679050444"><span class="annot"><a href="Lessons.Lesson05.html#many"><span class="hs-identifier hs-type">many</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Lessons.Lesson05.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050443"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050444"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Lessons.Lesson05.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050443"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679050444"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-64"></span><span id="many"><span class="annot"><span class="annottext">many :: forall e a. Parser e a -&gt; Parser e [a]
</span><a href="Lessons.Lesson05.html#many"><span class="hs-identifier hs-var hs-var">many</span></a></span></span><span> </span><span id="local-6989586621679050504"><span class="annot"><span class="annottext">Parser e a
</span><a href="#local-6989586621679050504"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser e a -&gt; [a] -&gt; [Char] -&gt; Either e ([a], [Char])
forall {t} {a} {a} {a}.
(t -&gt; Either a (a, t)) -&gt; [a] -&gt; t -&gt; Either a ([a], t)
</span><a href="#local-6989586621679050505"><span class="hs-identifier hs-var">many'</span></a></span><span> </span><span class="annot"><span class="annottext">Parser e a
</span><a href="#local-6989586621679050504"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-66"></span><span>    </span><span id="local-6989586621679050505"><span class="annot"><span class="annottext">many' :: (t -&gt; Either a (a, t)) -&gt; [a] -&gt; t -&gt; Either a ([a], t)
</span><a href="#local-6989586621679050505"><span class="hs-identifier hs-var hs-var">many'</span></a></span></span><span> </span><span id="local-6989586621679050506"><span class="annot"><span class="annottext">t -&gt; Either a (a, t)
</span><a href="#local-6989586621679050506"><span class="hs-identifier hs-var">p'</span></a></span></span><span> </span><span id="local-6989586621679050507"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679050507"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679050508"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679050508"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-67"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">t -&gt; Either a (a, t)
</span><a href="#local-6989586621679050506"><span class="hs-identifier hs-var">p'</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679050508"><span class="hs-identifier hs-var">input</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-68"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([a], t) -&gt; Either a ([a], t)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679050507"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679050508"><span class="hs-identifier hs-var">input</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679050509"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679050509"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679050510"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679050510"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(t -&gt; Either a (a, t)) -&gt; [a] -&gt; t -&gt; Either a ([a], t)
</span><a href="#local-6989586621679050505"><span class="hs-identifier hs-var">many'</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; Either a (a, t)
</span><a href="#local-6989586621679050506"><span class="hs-identifier hs-var">p'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679050507"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679050509"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679050510"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span id="local-6989586621679050442"><span class="annot"><a href="Lessons.Lesson05.html#many1"><span class="hs-identifier hs-type">many1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Lessons.Lesson05.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Lessons.Lesson05.html#ErrorMsg"><span class="hs-identifier hs-type">ErrorMsg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050442"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Lessons.Lesson05.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Lessons.Lesson05.html#ErrorMsg"><span class="hs-identifier hs-type">ErrorMsg</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679050442"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-72"></span><span id="many1"><span class="annot"><span class="annottext">many1 :: forall a. Parser ErrorMsg a -&gt; Parser ErrorMsg [a]
</span><a href="Lessons.Lesson05.html#many1"><span class="hs-identifier hs-var hs-var">many1</span></a></span></span><span> </span><span id="local-6989586621679050511"><span class="annot"><span class="annottext">Parser ErrorMsg a
</span><a href="#local-6989586621679050511"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679050512"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679050512"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Parser ErrorMsg a -&gt; [Char] -&gt; Either ErrorMsg ([a], [Char])
forall e a. Parser e a -&gt; Parser e [a]
</span><a href="Lessons.Lesson05.html#many"><span class="hs-identifier hs-var">many</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ErrorMsg a
</span><a href="#local-6989586621679050511"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679050512"><span class="hs-identifier hs-var">input</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-74"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679050513"><span class="annot"><span class="annottext">ErrorMsg
</span><a href="#local-6989586621679050513"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ErrorMsg -&gt; Either ErrorMsg ([a], [Char])
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">ErrorMsg
</span><a href="#local-6989586621679050513"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-75"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ErrorMsg -&gt; Either ErrorMsg ([a], [Char])
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;At least on value required&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-76"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679050514"><span class="annot"><span class="annottext">([a], [Char])
</span><a href="#local-6989586621679050514"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([a], [Char]) -&gt; Either ErrorMsg ([a], [Char])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">([a], [Char])
</span><a href="#local-6989586621679050514"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span id="local-6989586621679050453"><span id="local-6989586621679050454"><span id="local-6989586621679050455"><span class="annot"><a href="Lessons.Lesson05.html#pmap"><span class="hs-identifier hs-type">pmap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679050453"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679050454"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Lessons.Lesson05.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050455"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050453"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Lessons.Lesson05.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050455"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050454"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-79"></span><span id="pmap"><span class="annot"><span class="annottext">pmap :: forall a b e. (a -&gt; b) -&gt; Parser e a -&gt; Parser e b
</span><a href="Lessons.Lesson05.html#pmap"><span class="hs-identifier hs-var hs-var">pmap</span></a></span></span><span> </span><span id="local-6989586621679050516"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679050516"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679050517"><span class="annot"><span class="annottext">Parser e a
</span><a href="#local-6989586621679050517"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679050518"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679050518"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Parser e a
</span><a href="#local-6989586621679050517"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679050518"><span class="hs-identifier hs-var">input</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-81"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679050519"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679050519"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">e -&gt; Either e (b, [Char])
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679050519"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-82"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679050520"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679050520"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679050521"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679050521"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(b, [Char]) -&gt; Either e (b, [Char])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679050516"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679050520"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679050521"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-keyword">data</span><span> </span><span id="Food"><span class="annot"><a href="Lessons.Lesson05.html#Food"><span class="hs-identifier hs-var">Food</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Pizza"><span class="annot"><a href="Lessons.Lesson05.html#Pizza"><span class="hs-identifier hs-var">Pizza</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Sushi"><span class="annot"><a href="Lessons.Lesson05.html#Sushi"><span class="hs-identifier hs-var">Sushi</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Custom"><span class="annot"><a href="Lessons.Lesson05.html#Custom"><span class="hs-identifier hs-var">Custom</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679050526"><span id="local-6989586621679050533"><span id="local-6989586621679050537"><span class="annot"><span class="annottext">Int -&gt; Food -&gt; [Char] -&gt; [Char]
[Food] -&gt; [Char] -&gt; [Char]
Food -&gt; [Char]
(Int -&gt; Food -&gt; [Char] -&gt; [Char])
-&gt; (Food -&gt; [Char]) -&gt; ([Food] -&gt; [Char] -&gt; [Char]) -&gt; Show Food
forall a.
(Int -&gt; a -&gt; [Char] -&gt; [Char])
-&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; [Char] -&gt; [Char]) -&gt; Show a
$cshowsPrec :: Int -&gt; Food -&gt; [Char] -&gt; [Char]
showsPrec :: Int -&gt; Food -&gt; [Char] -&gt; [Char]
$cshow :: Food -&gt; [Char]
show :: Food -&gt; [Char]
$cshowList :: [Food] -&gt; [Char] -&gt; [Char]
showList :: [Food] -&gt; [Char] -&gt; [Char]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span id="local-6989586621679050462"><span id="local-6989586621679050463"><span class="annot"><a href="Lessons.Lesson05.html#orElse"><span class="hs-identifier hs-type">orElse</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="#local-6989586621679050462"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Lessons.Lesson05.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050462"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050463"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Lessons.Lesson05.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050462"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050463"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Lessons.Lesson05.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050462"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050463"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-87"></span><span id="orElse"><span class="annot"><span class="annottext">orElse :: forall e a. Semigroup e =&gt; Parser e a -&gt; Parser e a -&gt; Parser e a
</span><a href="Lessons.Lesson05.html#orElse"><span class="hs-identifier hs-var hs-var">orElse</span></a></span></span><span> </span><span id="local-6989586621679050544"><span class="annot"><span class="annottext">Parser e a
</span><a href="#local-6989586621679050544"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span id="local-6989586621679050545"><span class="annot"><span class="annottext">Parser e a
</span><a href="#local-6989586621679050545"><span class="hs-identifier hs-var">p2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679050546"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679050546"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Parser e a
</span><a href="#local-6989586621679050544"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679050546"><span class="hs-identifier hs-var">input</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-89"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679050547"><span class="annot"><span class="annottext">(a, [Char])
</span><a href="#local-6989586621679050547"><span class="hs-identifier hs-var">r1</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, [Char]) -&gt; Either e (a, [Char])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(a, [Char])
</span><a href="#local-6989586621679050547"><span class="hs-identifier hs-var">r1</span></a></span><span>
</span><span id="line-90"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679050548"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679050548"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-91"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Parser e a
</span><a href="#local-6989586621679050545"><span class="hs-identifier hs-var">p2</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679050546"><span class="hs-identifier hs-var">input</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-92"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679050549"><span class="annot"><span class="annottext">(a, [Char])
</span><a href="#local-6989586621679050549"><span class="hs-identifier hs-var">r2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, [Char]) -&gt; Either e (a, [Char])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(a, [Char])
</span><a href="#local-6989586621679050549"><span class="hs-identifier hs-var">r2</span></a></span><span>
</span><span id="line-93"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679050550"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679050550"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">e -&gt; Either e (a, [Char])
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(e -&gt; Either e (a, [Char])) -&gt; e -&gt; Either e (a, [Char])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679050548"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">e -&gt; e -&gt; e
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679050550"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span id="local-6989586621679050470"><span id="local-6989586621679050471"><span id="local-6989586621679050472"><span id="local-6989586621679050473"><span class="annot"><a href="Lessons.Lesson05.html#and3"><span class="hs-identifier hs-type">and3</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Lessons.Lesson05.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050470"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050471"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Lessons.Lesson05.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050470"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050472"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Lessons.Lesson05.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050470"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050473"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Lessons.Lesson05.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679050470"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679050471"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679050472"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679050473"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-96"></span><span id="and3"><span class="annot"><span class="annottext">and3 :: forall e a b c.
Parser e a -&gt; Parser e b -&gt; Parser e c -&gt; Parser e (a, b, c)
</span><a href="Lessons.Lesson05.html#and3"><span class="hs-identifier hs-var hs-var">and3</span></a></span></span><span> </span><span id="local-6989586621679050552"><span class="annot"><span class="annottext">Parser e a
</span><a href="#local-6989586621679050552"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span id="local-6989586621679050553"><span class="annot"><span class="annottext">Parser e b
</span><a href="#local-6989586621679050553"><span class="hs-identifier hs-var">p2</span></a></span></span><span> </span><span id="local-6989586621679050554"><span class="annot"><span class="annottext">Parser e c
</span><a href="#local-6989586621679050554"><span class="hs-identifier hs-var">p3</span></a></span></span><span> </span><span id="local-6989586621679050555"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679050555"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-97"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Parser e a
</span><a href="#local-6989586621679050552"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679050555"><span class="hs-identifier hs-var">input</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-98"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679050556"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679050556"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">e -&gt; Either e ((a, b, c), [Char])
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679050556"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-99"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679050557"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679050557"><span class="hs-identifier hs-var">v1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679050558"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679050558"><span class="hs-identifier hs-var">r1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-100"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Parser e b
</span><a href="#local-6989586621679050553"><span class="hs-identifier hs-var">p2</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679050558"><span class="hs-identifier hs-var">r1</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-101"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679050559"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679050559"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">e -&gt; Either e ((a, b, c), [Char])
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679050559"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-102"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679050560"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679050560"><span class="hs-identifier hs-var">v2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679050561"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679050561"><span class="hs-identifier hs-var">r2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-103"></span><span>                    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Parser e c
</span><a href="#local-6989586621679050554"><span class="hs-identifier hs-var">p3</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679050561"><span class="hs-identifier hs-var">r2</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-104"></span><span>                        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679050562"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679050562"><span class="hs-identifier hs-var">e3</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">e -&gt; Either e ((a, b, c), [Char])
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679050562"><span class="hs-identifier hs-var">e3</span></a></span><span>
</span><span id="line-105"></span><span>                        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679050563"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679050563"><span class="hs-identifier hs-var">v3</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679050564"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679050564"><span class="hs-identifier hs-var">r3</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">((a, b, c), [Char]) -&gt; Either e ((a, b, c), [Char])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679050557"><span class="hs-identifier hs-var">v1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679050560"><span class="hs-identifier hs-var">v2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679050563"><span class="hs-identifier hs-var">v3</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679050564"><span class="hs-identifier hs-var">r3</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="annot"><a href="Lessons.Lesson05.html#keyword"><span class="hs-identifier hs-type">keyword</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Lessons.Lesson05.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Lessons.Lesson05.html#ErrorMsg"><span class="hs-identifier hs-type">ErrorMsg</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-108"></span><span id="keyword"><span class="annot"><span class="annottext">keyword :: [Char] -&gt; Parser ErrorMsg [Char]
</span><a href="Lessons.Lesson05.html#keyword"><span class="hs-identifier hs-var hs-var">keyword</span></a></span></span><span> </span><span id="local-6989586621679050566"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679050566"><span class="hs-identifier hs-var">prefix</span></a></span></span><span> </span><span id="local-6989586621679050567"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679050567"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679050566"><span class="hs-identifier hs-var">prefix</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; Bool
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Bool
</span><span class="hs-operator hs-var">`isPrefixOf`</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679050567"><span class="hs-identifier hs-var">input</span></a></span><span> </span><span class="hs-keyword">then</span><span>
</span><span id="line-110"></span><span>        </span><span class="annot"><span class="annottext">([Char], [Char]) -&gt; Either ErrorMsg ([Char], [Char])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679050566"><span class="hs-identifier hs-var">prefix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Char] -&gt; [Char]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679050566"><span class="hs-identifier hs-var">prefix</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679050567"><span class="hs-identifier hs-var">input</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ErrorMsg -&gt; Either ErrorMsg ([Char], [Char])
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679050566"><span class="hs-identifier hs-var">prefix</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; is expected, got &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; [Char]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679050567"><span class="hs-identifier hs-var">input</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="annot"><a href="Lessons.Lesson05.html#ws"><span class="hs-identifier hs-type">ws</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Lessons.Lesson05.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Lessons.Lesson05.html#ErrorMsg"><span class="hs-identifier hs-type">ErrorMsg</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-114"></span><span id="ws"><span class="annot"><span class="annottext">ws :: Parser ErrorMsg ErrorMsg
</span><a href="Lessons.Lesson05.html#ws"><span class="hs-identifier hs-var hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser ErrorMsg [Char] -&gt; Parser ErrorMsg ErrorMsg
forall a. Parser ErrorMsg a -&gt; Parser ErrorMsg [a]
</span><a href="Lessons.Lesson05.html#many1"><span class="hs-identifier hs-var">many1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Parser ErrorMsg [Char]
</span><a href="Lessons.Lesson05.html#keyword"><span class="hs-identifier hs-var">keyword</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser ErrorMsg [Char]
-&gt; Parser ErrorMsg [Char] -&gt; Parser ErrorMsg [Char]
forall e a. Semigroup e =&gt; Parser e a -&gt; Parser e a -&gt; Parser e a
</span><a href="Lessons.Lesson05.html#orElse"><span class="hs-operator hs-var">`orElse`</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Parser ErrorMsg [Char]
</span><a href="Lessons.Lesson05.html#keyword"><span class="hs-identifier hs-var">keyword</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;\t&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="annot"><a href="Lessons.Lesson05.html#parsePizza"><span class="hs-identifier hs-type">parsePizza</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Lessons.Lesson05.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Lessons.Lesson05.html#ErrorMsg"><span class="hs-identifier hs-type">ErrorMsg</span></a></span><span> </span><span class="annot"><a href="Lessons.Lesson05.html#Food"><span class="hs-identifier hs-type">Food</span></a></span><span>
</span><span id="line-117"></span><span id="parsePizza"><span class="annot"><span class="annottext">parsePizza :: Parser ErrorMsg Food
</span><a href="Lessons.Lesson05.html#parsePizza"><span class="hs-identifier hs-var hs-var">parsePizza</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Food) -&gt; Parser ErrorMsg [Char] -&gt; Parser ErrorMsg Food
forall a b e. (a -&gt; b) -&gt; Parser e a -&gt; Parser e b
</span><a href="Lessons.Lesson05.html#pmap"><span class="hs-identifier hs-var">pmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Food -&gt; [Char] -&gt; Food
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Food
</span><a href="Lessons.Lesson05.html#Pizza"><span class="hs-identifier hs-var">Pizza</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Parser ErrorMsg [Char] -&gt; Parser ErrorMsg Food)
-&gt; Parser ErrorMsg [Char] -&gt; Parser ErrorMsg Food
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Parser ErrorMsg [Char]
</span><a href="Lessons.Lesson05.html#keyword"><span class="hs-identifier hs-var">keyword</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;pizza&quot;</span></span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span class="annot"><a href="Lessons.Lesson05.html#parseSushi"><span class="hs-identifier hs-type">parseSushi</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Lessons.Lesson05.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Lessons.Lesson05.html#ErrorMsg"><span class="hs-identifier hs-type">ErrorMsg</span></a></span><span> </span><span class="annot"><a href="Lessons.Lesson05.html#Food"><span class="hs-identifier hs-type">Food</span></a></span><span>
</span><span id="line-120"></span><span id="parseSushi"><span class="annot"><span class="annottext">parseSushi :: Parser ErrorMsg Food
</span><a href="Lessons.Lesson05.html#parseSushi"><span class="hs-identifier hs-var hs-var">parseSushi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Food) -&gt; Parser ErrorMsg [Char] -&gt; Parser ErrorMsg Food
forall a b e. (a -&gt; b) -&gt; Parser e a -&gt; Parser e b
</span><a href="Lessons.Lesson05.html#pmap"><span class="hs-identifier hs-var">pmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Food -&gt; [Char] -&gt; Food
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Food
</span><a href="Lessons.Lesson05.html#Sushi"><span class="hs-identifier hs-var">Sushi</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Parser ErrorMsg [Char] -&gt; Parser ErrorMsg Food)
-&gt; Parser ErrorMsg [Char] -&gt; Parser ErrorMsg Food
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Parser ErrorMsg [Char]
</span><a href="Lessons.Lesson05.html#keyword"><span class="hs-identifier hs-var">keyword</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;sushi&quot;</span></span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="annot"><a href="Lessons.Lesson05.html#parseCustom"><span class="hs-identifier hs-type">parseCustom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Lessons.Lesson05.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Lessons.Lesson05.html#ErrorMsg"><span class="hs-identifier hs-type">ErrorMsg</span></a></span><span> </span><span class="annot"><a href="Lessons.Lesson05.html#Food"><span class="hs-identifier hs-type">Food</span></a></span><span>
</span><span id="line-123"></span><span id="parseCustom"><span class="annot"><span class="annottext">parseCustom :: Parser ErrorMsg Food
</span><a href="Lessons.Lesson05.html#parseCustom"><span class="hs-identifier hs-var hs-var">parseCustom</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(([Char], ErrorMsg, [Char]) -&gt; Food)
-&gt; Parser ErrorMsg ([Char], ErrorMsg, [Char])
-&gt; Parser ErrorMsg Food
forall a b e. (a -&gt; b) -&gt; Parser e a -&gt; Parser e b
</span><a href="Lessons.Lesson05.html#pmap"><span class="hs-identifier hs-var">pmap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ErrorMsg
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679050575"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679050575"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Food
</span><a href="Lessons.Lesson05.html#Custom"><span class="hs-identifier hs-var">Custom</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679050575"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Parser ErrorMsg ([Char], ErrorMsg, [Char])
 -&gt; Parser ErrorMsg Food)
-&gt; Parser ErrorMsg ([Char], ErrorMsg, [Char])
-&gt; Parser ErrorMsg Food
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Parser ErrorMsg [Char]
-&gt; Parser ErrorMsg ErrorMsg
-&gt; Parser ErrorMsg [Char]
-&gt; Parser ErrorMsg ([Char], ErrorMsg, [Char])
forall e a b c.
Parser e a -&gt; Parser e b -&gt; Parser e c -&gt; Parser e (a, b, c)
</span><a href="Lessons.Lesson05.html#and3"><span class="hs-identifier hs-var">and3</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Parser ErrorMsg [Char]
</span><a href="Lessons.Lesson05.html#keyword"><span class="hs-identifier hs-var">keyword</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;custom&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser ErrorMsg ErrorMsg
</span><a href="Lessons.Lesson05.html#ws"><span class="hs-identifier hs-var">ws</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ErrorMsg [Char]
</span><a href="Lessons.Lesson05.html#parseString"><span class="hs-identifier hs-var">parseString</span></a></span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span class="hs-comment">-- &gt;&gt;&gt; parseFood &quot;pizza fdsf&quot;</span><span>
</span><span id="line-126"></span><span class="hs-comment">-- Right (Pizza,&quot; fdsf&quot;)</span><span>
</span><span id="line-127"></span><span class="hs-comment">-- &gt;&gt;&gt; parseFood &quot;sushi&quot;</span><span>
</span><span id="line-128"></span><span class="hs-comment">-- Right (Sushi,&quot;&quot;)</span><span>
</span><span id="line-129"></span><span class="hs-comment">-- &gt;&gt;&gt; parseFood &quot;custom buritto &quot;</span><span>
</span><span id="line-130"></span><span class="hs-comment">-- Right (Custom &quot;buritto&quot;,&quot; &quot;)</span><span>
</span><span id="line-131"></span><span class="hs-comment">-- &gt;&gt;&gt; parseFood &quot;customburitto &quot;</span><span>
</span><span id="line-132"></span><span class="hs-comment">-- Left [&quot;pizza is expected, got customburitto &quot;,&quot;sushi is expected, got customburitto &quot;,&quot;At least on value required&quot;]</span><span>
</span><span id="line-133"></span><span class="hs-comment">-- &gt;&gt;&gt; parseFood &quot;custom   &quot;</span><span>
</span><span id="line-134"></span><span class="hs-comment">-- Left [&quot;pizza is expected, got custom   &quot;,&quot;sushi is expected, got custom   &quot;,&quot;At least on value required&quot;]</span><span>
</span><span id="line-135"></span><span class="annot"><a href="Lessons.Lesson05.html#parseFood"><span class="hs-identifier hs-type">parseFood</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Lessons.Lesson05.html#Parser"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="Lessons.Lesson05.html#ErrorMsg"><span class="hs-identifier hs-type">ErrorMsg</span></a></span><span> </span><span class="annot"><a href="Lessons.Lesson05.html#Food"><span class="hs-identifier hs-type">Food</span></a></span><span>
</span><span id="line-136"></span><span class="hs-comment">-- orElse (orElse parsePizza parseSushi) parseCustom</span><span>
</span><span id="line-137"></span><span id="parseFood"><span class="annot"><span class="annottext">parseFood :: Parser ErrorMsg Food
</span><a href="Lessons.Lesson05.html#parseFood"><span class="hs-identifier hs-var hs-var">parseFood</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser ErrorMsg Food
</span><a href="Lessons.Lesson05.html#parsePizza"><span class="hs-identifier hs-var">parsePizza</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ErrorMsg Food
-&gt; Parser ErrorMsg Food -&gt; Parser ErrorMsg Food
forall e a. Semigroup e =&gt; Parser e a -&gt; Parser e a -&gt; Parser e a
</span><a href="Lessons.Lesson05.html#orElse"><span class="hs-operator hs-var">`orElse`</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ErrorMsg Food
</span><a href="Lessons.Lesson05.html#parseSushi"><span class="hs-identifier hs-var">parseSushi</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ErrorMsg Food
-&gt; Parser ErrorMsg Food -&gt; Parser ErrorMsg Food
forall e a. Semigroup e =&gt; Parser e a -&gt; Parser e a -&gt; Parser e a
</span><a href="Lessons.Lesson05.html#orElse"><span class="hs-operator hs-var">`orElse`</span></a></span><span> </span><span class="annot"><span class="annottext">Parser ErrorMsg Food
</span><a href="Lessons.Lesson05.html#parseCustom"><span class="hs-identifier hs-var">parseCustom</span></a></span><span>
</span><span id="line-138"></span></pre></body></html>